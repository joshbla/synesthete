##
# Smoke-test override config
#
# Use with:
#   uv run python run_pipeline.py --smoke --force-all
#
# This file intentionally contains ONLY overrides vs config/default.yaml.
# That keeps it from drifting when you add/remove fields elsewhere.
##

data:
  # Faster smoke: shorter + fewer frames
  duration: 1.5
  height: 128
  width: 128
  fps: 15
  num_samples: 60
  # Phase 5 helper: prove audio dependence quickly.
  # You can set this true temporarily to train on only deterministic, strongly reactive debug programs.
  audio_debug_mode: false
  # Or mix debug programs into normal sampling to gradually reintroduce diversity.
  audio_debug_mix_prob: 0.25

model:
  frame_size: [128, 128]
  # duration * fps = ~22 frames
  num_frames: 22
  d_model: 256

vae:
  epochs: 1
  samples_per_epoch: 150
  batch_size: 32

diffusion:
  epochs: 1
  samples_per_epoch: 250
  batch_size: 16
  timesteps: 15
  frames_per_clip: 10
  # Phase 4 temporal knobs
  # - seq_len: how many contiguous frames are used per training snippet (higher = more temporal learning).
  seq_len: 8
  # - prev_latent_weight: strength of previous-frame latent conditioning (0 disables temporal coupling).
  prev_latent_weight: 1.0
  # Phase 4 training robustness knobs (reduce train/infer mismatch)
  # - p_prev_latent_drop: randomly drop prev_latent conditioning (can reduce over-smoothing).
  p_prev_latent_drop: 0.1
  # - p_prev_latent_noisy: replace prev_latent with one noised to the current timestep t (improves robustness).
  p_prev_latent_noisy: 0.5

tracker:
  enabled: false

inference:
  output_video: "outputs/output_smoke.mp4"
  # Default smoke behavior: sample a random style (matches "real" generation).
  # If you suspect style is masking audio-reactivity, temporarily set:
  #   style_mode: "zero"
  style_mode: "random"
  # For easier A/B comparisons, you can set a fixed seed here.
  # Leave null for maximum variety.
  style_seed: 123

# Phase 3 smoke knobs: keep variety high but not too chaotic.
# If outputs look "static-y blobs", reduce aug/composite first before changing primitives.
visualizers:
  organic_prob: 0.5
  aug_prob: 0.2
  composite_prob: 0.2

